<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulation based on polar form specifications — sim_numbers • gbutils</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simulation based on polar form specifications — sim_numbers" />

<meta property="og:description" content="" />

<meta property="og:description" content="Simulate real and complex numbers from polar form specifications. The
  numbers may be partially or fully specified. The distributions of
  absolute values and arguments/signs are specified independently." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gbutils</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GeoBosh/gbutils">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation based on polar form specifications</h1>
    
    <div class="hidden name"><code>sim_numbers.Rd</code></div>
    </div>

    <div class="ref-description">
    
    

    <p>Simulate real and complex numbers from polar form specifications. The
  numbers may be partially or fully specified. The distributions of
  absolute values and arguments/signs are specified independently.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fu'>as.character</span>(<span class='fl'>NA</span>), <span class='fu'>length</span>(<span class='no'>abs</span>)),
            <span class='kw'>abs</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fu'>as.numeric</span>(<span class='fl'>NA</span>), <span class='fu'>length</span>(<span class='no'>type</span>)),
            <span class='kw'>sign</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fu'>as.numeric</span>(<span class='fl'>NA</span>), <span class='fu'>length</span>(<span class='no'>type</span>)), <span class='kw'>values</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>type</th>
      <td><p>character vector specifying the types of the eigenvalues,
    see Details.</p></td>
    </tr>
    <tr>
      <th>abs</th>
      <td><p>vector of absolute values (moduli).</p></td>
    </tr>
    <tr>
      <th>sign</th>
      <td><p>vector of signs (for reals) and  arguments (for complex
    numbers), see Details for interpretation.</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>values, see details.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>additional arguments to be passed to <code>sim_real</code> and
    <code>sim_complex</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><!-- % NA's are filled with simulated values. --></p>
<p><code>sim_numbers</code> simulates a vector of real and complex numbers with
  given distributions of their polar parts. It is possible also to fix
  some of the numbers or one of their polar parts.
  The length of the simulated vector is inferred from the length of
  <code>type</code> or <code>abs</code>, so one of them must be
  provided. <code>sim_numbers</code> as a flexible front-end for
  <code>sim_real</code> and <code>sim_complex</code>.</p>
<p><code>sim_numbers</code> generates a vector of values with types specified
  by argument <code>type</code> and/or inferred from argument <code>values</code>.
  The recommended way to use <code>sim_numbers</code> is to provide argument
  <code>type</code>. <!-- % and use the other arguments only when needed. --></p>
<p><code>type[i]</code> specifies the type of the i-th element of the result:
  real (<code>type[i]=="r"</code>), complex (<code>type[i]=="c"</code>) or
  representing a complex conjugate pair (<code>type[i]=="cp"</code>).  If
  <code>values</code> is provided, the imaginary parts of its non-NA elements
  are used to fill <code>NA</code> elements of <code>type</code> ("r" if zero, "cp"
  otherwise).</p>
<p>Some (or even all) values may be fixed or partially fixed with the
  help of arguments <code>abs</code>, <code>sign</code> and <code>values</code>. A
  non-missing value of <code>values[i]</code> fixes the i-th element of the
  result to that value. Simlarly <code>abs[i]</code> fixes the modulus and
  <code>sign[i]</code> fixes the sign/argument of the i-th element. If
  <code>values[i]</code> is not <code>NA</code>, then it takes precedence and
  <code>abs[i]</code> and <code>sign[i]</code> are ignored.</p>
<p>For real numbers <code>sign</code> is the sign with possible values 1
  (positive) or -1 (negative). For complex numbers, <code>sign</code> is the
  argument and is in the interval (-pi,pi).</p>
<p>If <code>values</code> is supplied, then <code>NA</code> entries in <code>type</code>
  are replaced by "r" or "cp" depending on whether or not the imaginary
  parts of the corresponding entries in <code>values</code> are equal to zero.
  A check is done for consistency when both <code>type[i]</code> and
  <code>values[i]</code> are non-missing. Generally, <code>values</code> is meant to
  be used for values that are fixed and available directly in Cartesian
  form, to avoid having to fill the corresponding entries of <code>abs</code>
  and <code>sign</code>.</p>
<p><code>NA</code> entries of <code>abs</code> and <code>sign</code> are filled with
  simulated values, the remaining entries are considered fixed and left
  unchanged. The default generator is uniform (0,1) for <code>abs</code>,
  uniform (-pi,pi) for the argument of complex values, and 1 or -1 with
  p=1/2 for the sign of real values.</p>
<p>To specify a different generator for the moduli and absolute values,
  use argument <code>absgen</code>, giving it a function or the name of a
  function. The arguments for this function can be specified by
  <code>absarg</code> (as a list). Similarly, the generator for arguments of
  complex numbers can be specified by <code>arggen</code> and <code>argarg</code>.
  Finally, the probability for the real numbers to be positive is given
  by <code>signprob</code>. These arguments are not in the signature of the
  function since they are passed on directly (via <code>"..."</code>) to the
  underlying <code>sim_complex</code> and <code>sim_real</code>, see their
  documentation and the examples below for further details.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with components</p>
<dt>values</dt><dd><p>vector of values; it is of type <code>numeric</code> if
    all values are real and <code>complex</code> otherwise.</p></dd>
  <dt>type</dt><dd><p>a character vector of the types as above</p></dd>

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Values of type "cp" (complex pairs) are represented by one element, the
  complex conjugate elements are NOT generated. (todo: maybe add an
  argument to control this)</p>
<p>The convention for the sign of a real eigenvalue is 1 and -1,
  not 0 and pi.
  <!-- % In the lower level function \code{sim_real} this argument -->
  <!-- % is called \code{sign} not \code{arg}. --></p>
<p>The checks for consistency between <code>type</code> and <code>values</code> are
  not complete and only straightforward use is recommended.</p>
<p>The current defaults for the arguments, see the signature
  above, require that at least one of <code>type</code> and <code>abs</code> is not
  missing.</p>
<p><!-- % For compatility with old versions of the function (before the -->
  <!-- % introduction of \code{type}), \code{values} may be a character -->
  <!-- % vector. In this case \code{type} is set to \code{values}. --></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sim_complex.html'>sim_real</a></code><!-- % -->
  , <code><a href='sim_complex.html'>sim_complex</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## one real number and one complex conjugated pair</span>
<span class='co'>## (maybe to specify a cubic polynomial through its roots)</span>
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>))</div><div class='output co'>#&gt; $values
#&gt; [1]  0.69582388+0.0000000i -0.00477644-0.0308629i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp"
#&gt; </div><div class='input'>
<span class='co'>## here the real value is fixed to have modulus 1, leaving the sign unspecified</span>
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>), <span class='kw'>abs</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>NA</span>))</div><div class='output co'>#&gt; $values
#&gt; [1] -1.0000000+0.0000000i  0.6309461-0.0836389i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp"
#&gt; </div><div class='input'>
<span class='co'>## now the real value is fixed to 1,</span>
<span class='co'>##     the complex pair has argument  +-pi/2, and free modulus:</span>
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>), <span class='kw'>abs</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>NA</span>), <span class='kw'>sign</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='no'>pi</span>/<span class='fl'>2</span>))</div><div class='output co'>#&gt; $values
#&gt; [1] -1+0.0000000i  0+0.4321713i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp"
#&gt; </div><div class='input'>

<span class='co'>## using argument 'values' to fix some values;</span>
<span class='co'>## here the the third value is fixed:</span>
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>, <span class='st'>"r"</span>), <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='fl'>3</span>))  <span class='co'># type[3] = "r"</span></div><div class='output co'>#&gt; $values
#&gt; [1]  0.7064338+0.0000000i -0.0372360-0.1764527i  3.0000000+0.0000000i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp" "r" 
#&gt; </div><div class='input'><span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>, <span class='st'>"cp"</span>), <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='fl'>3i</span>)) <span class='co'># type[3] = "cp"</span></div><div class='output co'>#&gt; $values
#&gt; [1] -0.6801629+0.0000000i  0.3428605+0.5424012i  0.0000000+3.0000000i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp" "cp"
#&gt; </div><div class='input'>
<span class='co'>## type[3] can be left NA since it can be inferred from values[3]:</span>
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>, <span class='fl'>NA</span>), <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='fl'>3</span>))  <span class='co'># type[3] = "r"</span></div><div class='output co'>#&gt; $values
#&gt; [1]  0.09602416+0.0000000i -0.76836463+0.0448899i  3.00000000+0.0000000i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp" "r" 
#&gt; </div><div class='input'><span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>, <span class='fl'>NA</span>), <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='fl'>3i</span>)) <span class='co'># type[3] = "cp"</span></div><div class='output co'>#&gt; $values
#&gt; [1] -0.9705209+0.0000000i  0.1838019-0.4229773i  0.0000000+3.0000000i
#&gt; 
#&gt; $type
#&gt; [1] "r"  "cp" "cp"
#&gt; </div><div class='input'>
## it is an error to have a mismatch between args `type' and value:
</div><span class='co'># NOT RUN {</span>
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>, <span class='st'>"cp"</span>), <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='fl'>3</span>))
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"r"</span>, <span class='st'>"cp"</span>, <span class='st'>"r"</span>), <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='fl'>3i</span>))
<span class='co'># }</span><div class='input'>
<span class='co'>## simulate 10 reals with the default generators</span>
<span class='fu'>sim_numbers</span>(<span class='fu'>rep</span>(<span class='st'>"r"</span>, <span class='fl'>10</span>))</div><div class='output co'>#&gt; $values
#&gt;  [1]  0.17467589 -0.53157354  0.49363702 -0.77930863  0.20417834  0.71339728
#&gt;  [7]  0.06521611 -0.35420680 -0.82519942 -0.27381825
#&gt; 
#&gt; $type
#&gt;  [1] "r" "r" "r" "r" "r" "r" "r" "r" "r" "r"
#&gt; </div><div class='input'>
<span class='co'>## simulate modulus from Rayleigh distribution</span>
<span class='co'>##</span>
<span class='no'>rR</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>n</span>, <span class='no'>sigma</span> <span class='kw'>=</span> <span class='fl'>1</span>) <span class='no'>sigma</span> * <span class='fu'>sqrt</span>(-<span class='fl'>2</span>*<span class='fu'>log</span>(<span class='fu'>runif</span>(<span class='no'>n</span>)))
<span class='fu'>sim_numbers</span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"cp"</span>, <span class='st'>"cp"</span>), <span class='kw'>absgen</span> <span class='kw'>=</span> <span class='no'>rR</span>, <span class='kw'>absarg</span> <span class='kw'>=</span> <span class='fu'>list</span>())</div><div class='output co'>#&gt; $values
#&gt; [1]  2.060180-1.703645i -1.225989-0.155389i
#&gt; 
#&gt; $type
#&gt; [1] "cp" "cp"
#&gt; </div><div class='input'>
# test the the components are N(0,1)
## (not run to save time for CRAN check)
## \dontrun{
## v <- sim_numbers(type = rep("cp", 10000), absgen = "rR",
##                  absarg = list(sigma = 1))
## ks.test(Re(v$values), "pnorm")
## ks.test(Im(v$values), "pnorm")
## }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Georgi N. Boshnakov
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

